name: Release

on:
  workflow_dispatch:

jobs:
  release:
    permissions:
      id-token: write
      contents: write
      packages: write
      attestations: write
    # See https://github.com/Kotori316/common-script/blob/main/.github/workflows/release-prod-gradle.yaml
    uses: 'Kotori316/common-script/.github/workflows/release-prod-gradle.yaml@main'
    with:
      release_command: 'checkReleaseVersion assemble publishToMavenLocal curseforge modrinth githubRelease registerVersion publish --continue'
      enable_signature_check: true
      docker_image: 'mcr.microsoft.com/devcontainers/java:1-21-bullseye'
      sign_check_command: 'test runGameTestServer'
    secrets: inherit
